# 采购订单管理系统需求文档

## 1. 功能概述

采购订单管理系统是OMS React应用中的核心模块，负责管理采购订单的完整生命周期，从创建到关闭，包括供应商管理、物流跟踪、收货流程和异常处理。系统支持手动创建PO和从PR转换创建PO，提供完整的状态管理、批量操作、多维度筛选和实时跟踪功能。

## 1.1. 功能概述

### 核心功能模块
- **PO生命周期管理**: 支持8个状态的完整流转管理
- **供应商信息管理**: 维护供应商基本信息和联系方式
- **商品行管理**: 支持多商品行的数量、价格、规格管理
- **物流跟踪**: ASN创建、发运状态跟踪、承运商管理
- **收货管理**: 支持本地仓库和第三方仓库的收货流程
- **异常处理**: RTV退供流程、异常状态处理
- **批量操作**: 支持基于状态的智能批量操作
- **权限控制**: 基于创建方式和状态的编辑权限管理

### 业务价值
- 提高采购效率，减少手工操作错误
- 实现采购全流程可视化跟踪
- 支持多仓库、多供应商的复杂业务场景
- 提供完整的审计追踪和合规支持

## 1.2. 用户故事

### 主要用户角色
- **采购经理**: 负责采购策略制定和订单审批
- **采购员**: 负责日常采购订单创建和管理
- **仓库管理员**: 负责收货确认和库存管理
- **财务人员**: 负责采购成本核算和付款管理
- **供应商**: 通过系统接收订单和更新发货状态

### 核心用户故事
1. 作为采购员，我希望能够快速创建采购订单，以便高效完成采购任务
2. 作为采购经理，我希望能够实时跟踪所有采购订单状态，以便及时发现和处理问题
3. 作为仓库管理员，我希望能够方便地确认收货，以便准确更新库存
4. 作为财务人员，我希望能够查看采购订单的成本信息，以便进行财务核算

## 1.3. 业务流程

### PO状态流转图
```
NEW (新建)
├─ 发送供应商 → 供应商确认流程
├─ 创建发运单 → IN_TRANSIT (运输中)
├─ 直接创建收货单 → RECEIVING (收货中) [无需发运的直接收货场景]
└─ 取消 → CANCELLED (已取消)

IN_TRANSIT (运输中)
├─ 创建发运单 → 继续发运
└─ 标记送达 → WAITING_FOR_RECEIVING (待收货)

WAITING_FOR_RECEIVING (待收货)
├─ 创建发运单 → 继续发运
└─ 创建收货单 → RECEIVING (收货中)

RECEIVING (收货中)
├─ 创建发运单 → 继续发运 [补发货场景]
└─ 完成收货 → CLOSED (已关闭) / PARTIAL_RECEIPT (部分收货)

PARTIAL_RECEIPT (部分收货)
├─ 创建发运单 → 继续发运 [补发货场景]
└─ 创建收货单 → 继续收货流程
└─ 直接完成收货 → CLOSED (已关闭) [无需补发的直接完成场景]

CLOSED (已关闭)
└─ 复制 → 创建新PO

CANCELLED (已取消)
├─ 重开 → NEW (新建)
└─ 复制 → 创建新PO

EXCEPTION (异常)
├─ 重开 → NEW (新建)
├─ 复制 → 创建新PO
└─ 查看原因 → 异常详情
```

### 主要业务流程

#### 1. PO创建流程
1. **创建入口**：
   - 从PO列表页点击"新增PO"按钮
   - 选择创建方式：手动创建、从PR转换、从模板创建、批量导入
   
2. **信息填写**：
   - 基础信息：PO编号（自动生成）、原始PO编号、参考编号、优先级、部门、预算项目
   - 供应商信息：供应商名称、联系人、电话、邮箱、地址
   - 交付信息：目标仓库、预计交付日期、运输方式、贸易条款、付款条件
   - 商品行：通过商品选择对话框添加，设置数量、单价、规格等
   - 成本信息：运费、手续费、其他费用、税费设置
   - 附件备注：上传相关文档、填写特殊要求
   
3. **数据验证**：
   - 实时字段验证：格式检查、必填验证、业务规则验证
   - 保存前完整性检查：确保所有必填信息完整、数据逻辑正确
   
4. **保存选项**：
   - 保存草稿：保存为草稿状态，可后续继续编辑
   - 保存为已创建：保存为已创建状态，等待发送给供应商
   - 保存并发送：直接保存并发送给供应商确认

#### 2. 发运管理流程
1. 创建ASN（预发货通知）
2. 填写发运信息（承运商、跟踪号、预计到达时间）
3. 更新发运状态（已发货、运输中、已到达）
4. 异常处理（延误、丢失、损坏）

#### 3. 收货管理流程
1. **直接收货场景**（无需发运）:
   - 从NEW状态直接创建收货单
   - 适用于本地供应商直接送货、自提货物等场景
   - 直接进入RECEIVING状态，跳过物流跟踪环节
   
2. **标准收货场景**（需要发运）:
   - 货物先发运（IN_TRANSIT → WAITING_FOR_RECEIVING）
   - 到达后创建收货单进入RECEIVING状态
   
3. **收货操作**:
   - 本地仓库收货：直接在系统中确认收货
   - 第三方仓库收货：创建收货请求，等待仓库确认
   - 数量核对：记录实收数量、差异处理
   - 质量检查：记录质量状态、不合格品处理
   - 入库确认：更新库存、完成收货流程

4. **补发货场景**:
   - 在RECEIVING或PARTIAL_RECEIPT状态下仍可创建发运单
   - 适用于分批交付、补货等场景

#### 4. 异常处理流程
1. 异常识别：系统自动检测或人工标记异常
2. 异常分类：数量差异、质量问题、延期交付等
3. 处理方案：退供、补货、价格调整、取消订单
4. 跟踪处理：记录处理过程、更新状态、通知相关方

## 1.4. 业务规则

### 状态流转规则
1. **NEW → IN_TRANSIT**: 创建发运单后自动流转
2. **NEW → RECEIVING**: 直接创建收货单后流转（无需发运场景）
3. **IN_TRANSIT → WAITING_FOR_RECEIVING**: 标记送达后流转
4. **WAITING_FOR_RECEIVING → RECEIVING**: 开始收货后流转
5. **RECEIVING → PARTIAL_RECEIPT**: 部分收货完成后流转
6. **RECEIVING → CLOSED**: 全部收货完成后流转
7. **PARTIAL_RECEIPT → CLOSED**: 剩余货物直接完成收货后流转（无需补发场景）
8. **任何状态 → EXCEPTION**: 发生异常时可流转
9. **CANCELLED/EXCEPTION → NEW**: 重开订单时流转

### 数据验证规则
1. **PO编号**: 系统自动生成，格式为PO{YYYY}{8位序号}
2. **供应商信息**: 供应商名称、联系人为必填项
3. **商品行**: SKU、数量、单价为必填项，数量和单价必须大于0
4. **交付日期**: 预计交付日期不能早于当前日期
5. **金额计算**: 行金额 = 数量 × 单价 + 税额，总金额包含运费和其他费用

### 权限控制规则
1. **手动创建PO**: 所有字段可编辑（状态允许的情况下）
2. **PR转换PO**: 供应商、仓库、币种、SKU只读，数量和单价可编辑
3. **状态限制**: 已关闭、已取消状态下不允许编辑，仅可查看和复制
4. **批量操作**: 只能对相同状态的PO执行批量操作

### 仓库类型规则
1. **本地仓库**: 支持直接收货确认，一步完成入库和收货
2. **第三方仓库**: 需要创建收货请求，等待仓库方确认收货

## 1.5. 功能详细描述

### 列表页面功能

#### 搜索功能
- **基础搜索**: 支持PO编号、原始PO编号、参考编号、供应商名称、目的地、PR编号的模糊搜索
- **高级搜索**: 支持多字段组合搜索，包括批量搜索（支持换行分隔的多个值）
- **搜索历史**: 保存最近的搜索条件，支持快速重复搜索

#### 筛选功能
- **状态筛选**: 支持主状态、运输状态、收货状态的多选筛选
- **供应商筛选**: 支持多供应商同时筛选
- **仓库筛选**: 支持按目标仓库筛选
- **创建方式筛选**: 手动创建、PR转换、API导入
- **时间范围筛选**: 支持创建时间、预计到货时间范围筛选

#### 列表显示
- **默认列**: PO编号、状态、原始PO编号、参考编号、运输状态、收货状态、供应商、仓库、总数量、总价、创建时间、预计到货时间、操作
- **可选列**: 已发运数量、已收货数量、ASN数量、异常信息、承运商、目标城市、更新时间、运输方式、备注、采购日期
- **列自定义**: 支持显示/隐藏列、列宽调整、列顺序调整
- **粘性列**: 第一列和最后一列（操作列）固定，支持横向滚动时保持可见

#### 排序功能
- **默认排序**: 按创建时间倒序
- **支持排序字段**: 创建时间、更新时间、预计到货时间、总金额、总数量
- **多级排序**: 支持最多3级排序条件

#### 分页功能
- **分页大小**: 支持10、20、50、100条/页
- **分页导航**: 首页、上一页、下一页、末页、跳转到指定页
- **总数显示**: 显示当前页范围和总记录数

#### 批量操作
- **选择功能**: 支持单选、全选、反选
- **状态相关操作**: 根据选中PO的状态智能显示可用的批量操作
- **通用操作**: 批量导出、批量打印
- **状态特定操作**: 批量发送、批量创建发运单、批量标记送达、批量取消等

#### 行级操作
根据PO状态显示不同的操作按钮：
- **NEW**: 发送、创建发运单、直接创建收货单、取消
- **IN_TRANSIT**: 查看、创建发运单、标记送达
- **WAITING_FOR_RECEIVING**: 查看、创建发运单、创建收货单
- **RECEIVING**: 查看、创建发运单（补发货）、完成收货
- **PARTIAL_RECEIPT**: 查看、创建发运单（补发货）、创建收货单、直接完成收货
- **CLOSED**: 查看、复制
- **CANCELLED**: 查看、重开、复制
- **EXCEPTION**: 查看、重开、复制、查看原因

### 详情页面功能

#### 基本信息展示
- **订单信息卡片**: PO编号、原始PO编号、参考编号、数据来源、创建时间、预计到货时间、付款条款、交货条款、关联PR
- **供应商信息卡片**: 供应商名称、编码、联系人、电话、邮箱、地址，支持一键拨打电话和发送邮件
- **地址信息卡片**: 发货地址、收货地址，清晰区分发货方和收货方信息
- **物流跟踪卡片**: 发运记录汇总、收货记录汇总、最新发运信息、最新收货信息

#### 标签页内容
1. **商品行标签页**: 
   - 完整商品明细表格
   - 订购数量、已发运数量、已收货数量、退供数量对比
   - 行级状态和进度显示
   - 支持按商品行查看详细的发运和收货记录

2. **发运信息标签页**:
   - ASN记录列表，包含发运单号、发运数量、承运商、跟踪号、发运状态、预计到达时间
   - 发运状态时间线，显示发运各个阶段的时间节点
   - 支持跟踪号一键跳转到承运商官网查询

3. **收货记录标签页**:
   - 收货单记录列表，包含收货单号、收货时间、收货数量、收货人、收货状态、备注
   - 收货差异分析，对比计划收货和实际收货的差异
   - 质量检查结果，记录合格品、不合格品、损坏品数量

4. **退供信息标签页**:
   - RTV单记录列表，包含退供单号、退供时间、退供数量、退供原因、处理状态
   - 退供原因分析统计
   - 供应商确认状态和退款进度

#### 操作功能
- **状态相关操作**: 根据当前PO状态显示可用操作按钮
- **文档操作**: 下载PO、打印PO、导出详情
- **通信功能**: 发送邮件给供应商、记录沟通历史
- **数据刷新**: 手动刷新最新数据，显示刷新时间

### 创建页面功能

#### 基础信息区域
- **PO编号**: 系统自动生成，格式PO{YYYY}{8位序号}，不可编辑
- **原始PO编号**: 可选填写，用于关联外部系统的PO编号
- **参考编号**: 可选填写，用于内部参考和跟踪
- **优先级**: 下拉选择，包含普通、高、紧急三个级别
- **部门**: 下拉选择，用于成本中心分配和权限控制
- **预算项目**: 填写预算项目或成本中心代码，用于财务核算
- **采购类型**: 下拉选择，包含常规采购、库存补充、紧急采购等

#### 供应商与交付信息区域
- **供应商基本信息**: 
  - 供应商名称（必填）：支持搜索选择或手动输入
  - 供应商代码：自动填充或手动输入
  - 联系人（必填）：主要联系人姓名
  - 联系电话：支持格式验证
  - 联系邮箱：支持格式验证和一键发送邮件
  
- **地址信息**:
  - 发货地址：国家、省/州（必填）、城市（必填）、详细地址（必填）、邮编、联系人（必填）、电话
  - 收货地址：支持从预设仓库地址中选择，或手动填写
  
- **交付条件**:
  - 目标仓库（必填）：下拉选择可用仓库
  - 预计交付日期（必填）：日期选择器，不能早于当前日期
  - 最晚发货时间：可选设置，用于供应商参考
  - 运输方式：海运、空运、陆运、快递等
  - 运费条款：到付、预付等
  - 贸易条款：FOB、CIF、EXW等国际贸易术语

#### 商品行管理区域
- **商品选择功能**:
  - 商品选择对话框：支持按SKU、商品名称、品牌、分类搜索
  - 批量添加：支持一次选择多个商品
  - 商品信息展示：SKU、商品名称、规格、库存状态、建议单价
  
- **商品行编辑**:
  - 基本信息：行号（自动生成）、SKU代码、商品名称、规格描述
  - 数量信息：订购数量（必填，>0）、计量单位
  - 价格信息：币种选择、单价（必填，>0）、税率、税额（自动计算）、行金额（自动计算）
  - 尺寸信息：长、宽、高、体积（自动计算）
  - 其他信息：行级备注、预计交货日期
  
- **批量操作功能**:
  - 批量选择：支持全选、反选、按条件选择
  - 批量编辑：数量、币种、单价、税率、备注等字段的批量设置
  - 批量删除：删除选中的商品行
  - 批量设置：SN/LOT要求、供应商等批量设置
  
- **SN/LOT管理**:
  - 序列号管理：为需要序列号跟踪的商品预先指定序列号
  - 批次号管理：为需要批次管理的商品指定批次号
  - 管理对话框：提供专门的界面进行SN/LOT的添加、编辑、删除

#### 成本信息区域
- **费用项目**:
  - 运输费用：运费金额，支持含税/不含税设置
  - 手续费：银行手续费、代理费等
  - 其他费用：保险费、检验费等额外费用
  
- **税费计算**:
  - 运费税率：运费的税率设置
  - 运费税额：根据运费和税率自动计算
  - 总税额：所有税费的汇总
  
- **金额汇总**:
  - 按币种分组显示：不同币种的小计、税额、总计
  - 总计金额：包含所有费用的最终总金额
  - 实时更新：任何数量或价格变更时自动重新计算

#### 附件和备注区域
- **文件上传**:
  - 支持格式：PDF、Word、Excel、图片（JPG、PNG）等
  - 多文件上传：支持一次上传多个文件
  - 文件预览：支持在线预览部分格式文件
  - 文件管理：上传后可重命名、删除、下载
  
- **备注信息**:
  - 采购备注：内部使用的备注信息
  - 供应商备注：发送给供应商的特殊要求
  - 交付说明：关于交付的特殊说明
  - 质量要求：对商品质量的特殊要求

#### 页面操作功能
- **保存选项**:
  - 保存草稿：保存为DRAFT状态，可后续继续编辑，不进行完整性验证
  - 保存为已创建：保存为NEW状态，进行完整性验证，等待后续操作
  - 保存并发送：保存后直接发送给供应商，需要完整性验证通过
  
- **数据验证**:
  - 实时验证：字段失去焦点时立即进行格式和业务规则验证
  - 保存前验证：执行完整的数据完整性和业务规则检查
  - 错误提示：清晰的错误信息显示和修改建议
  
- **辅助功能**:
  - 自动保存：定期自动保存草稿，防止数据丢失
  - 数据恢复：页面刷新后可恢复未保存的数据
  - 快捷操作：键盘快捷键支持，提高操作效率
  - 操作历史：记录用户的操作历史，支持撤销/重做

### 编辑页面功能

#### 权限控制显示
- **编辑权限提示**: 清晰显示哪些字段可编辑、哪些只读、哪些不可见
- **状态限制说明**: 根据当前PO状态说明编辑限制原因
- **创建方式影响**: 区分手动创建PO和PR转换PO的编辑权限差异

#### 字段编辑规则
1. **手动创建PO**:
   - 草稿/已创建状态: 大部分字段可编辑
   - 其他状态: 仅备注、附件等非关键字段可编辑

2. **PR转换PO**:
   - 供应商信息: 只读（继承自PR）
   - 目标仓库: 只读（继承自PR）
   - 币种: 只读（继承自PR）
   - 商品行SKU: 只读，不可删除（继承自PR）
   - 数量: 可编辑（但不能超过PR剩余数量）
   - 单价: 根据企业规则决定是否可编辑

#### 数据验证
- **实时验证**: 字段失去焦点时立即验证
- **保存前验证**: 保存前进行完整性检查
- **业务规则验证**: 检查业务逻辑合规性
- **错误提示**: 清晰的错误信息和修改建议

### 状态管理功能

#### 三层状态体系
1. **主状态（PO Status）**: 影响PO生命周期的核心状态
   - NEW: 新建
   - IN_TRANSIT: 运输中  
   - WAITING_FOR_RECEIVING: 待收货
   - RECEIVING: 收货中
   - PARTIAL_RECEIPT: 部分收货
   - CLOSED: 已关闭
   - CANCELLED: 已取消
   - EXCEPTION: 异常

2. **运输状态（Shipping Status）**: 物流相关的扩展状态
   - SHIPPED: 已发货
   - IN_TRANSIT: 运输中
   - ARRIVED: 已到达
   - SHIPPING_EXCEPTION: 运输异常

3. **收货状态（Receiving Status）**: 收货相关的扩展状态
   - NOT_RECEIVED: 未收货
   - PARTIAL_RECEIVED: 部分收货
   - RECEIVED: 已收货

#### 状态流转控制
- **自动流转**: 基于业务操作自动更新状态
- **手动流转**: 支持特定情况下的手动状态调整
- **流转验证**: 确保状态流转符合业务规则
- **流转记录**: 记录所有状态变更的时间、操作人、原因

#### 状态显示
- **颜色编码**: 不同状态使用不同颜色标识，符合设计系统规范
- **图标支持**: 状态徽章支持图标显示，增强视觉识别
- **多语言**: 支持中英文状态标签切换
- **状态说明**: 鼠标悬停显示状态详细说明

### 本地仓库收货功能

#### 收货确认对话框
- **PO信息展示**: 显示PO编号、供应商、仓库等基本信息
- **商品行列表**: 显示所有待收货商品行，包括SKU、商品名称、规格、计划数量、已收数量
- **收货数量输入**: 支持逐行输入实际收货数量
- **批量操作**: 支持批量设置收货数量（如全部收货、按比例收货）
- **差异处理**: 自动计算收货差异，支持差异原因选择
- **质量检查**: 记录合格品、不合格品、损坏品数量
- **收货备注**: 支持整单备注和行级备注

#### 收货验证
- **数量验证**: 收货数量不能为负数，超收需要确认
- **必填验证**: 确保关键信息完整填写
- **业务规则验证**: 检查收货业务规则合规性

#### 收货结果处理
- **状态更新**: 根据收货结果自动更新PO状态
- **库存更新**: 收货确认后自动更新库存数量
- **通知发送**: 向相关人员发送收货完成通知
- **单据生成**: 自动生成收货单据

## 术语表

- **PO**: Purchase Order - 采购订单，买方向卖方发出的商业文件
- **PR**: Purchase Request - 采购申请，可转换为PO的内部申请
- **ASN**: Advance Ship Notice - 预发货通知，待交付的通知
- **RTV**: Return to Vendor - 退供，将货物退回供应商的流程
- **SKU**: Stock Keeping Unit - 库存单位，产品标识符
- **UOM**: Unit of Measure - 计量单位，产品的测量单位
- **Incoterm**: International Commercial Terms - 国际贸易术语，用于运输的国际商业条款
- **本地仓库**: 公司自有的仓库设施
- **第三方仓库**: 外部仓库设施
- **系统**: 采购订单管理系统

## 需求规格

### 需求1：PO生命周期管理

**用户故事：** 作为采购经理，我希望能够管理采购订单的完整生命周期，以便能够全程跟踪订单从创建到完成的过程。

#### 验收标准

1. 系统应支持八个不同的PO状态：NEW（新建）、IN_TRANSIT（运输中）、WAITING_FOR_RECEIVING（待收货）、RECEIVING（收货中）、PARTIAL_RECEIPT（部分收货）、CLOSED（已关闭）、CANCELLED（已取消）、EXCEPTION（异常）
2. 当PO在状态间转换时，系统应记录转换时间戳和触发用户
3. 系统应根据业务规则强制执行有效的状态转换
4. 当PO达到CLOSED状态时，系统应阻止进一步修改，除了查看和复制功能
5. 系统应维护所有状态变更的完整审计跟踪

### 需求2：PO创建和管理

**用户故事：** 作为采购员，我希望能够手动创建采购订单或从采购申请创建，以便高效地进行采购。

#### 验收标准

1. 系统应支持手动创建PO，包含完整的供应商和商品行信息
2. 系统应支持PO创建从现有PR记录创建PO，并继承数据
3. 创建PO时，系统应使用格式PO{YYYY}{8位序号}自动生成唯一的PO编号
4. 系统应在允许创建PO之前验证所有必填字段
5. 系统应支持保存不完整PO的草稿
6. 系统应允许向PO附加支持文档
7. 系统应提供PO创建向导，引导用户完成必要信息填写
8. 系统应支持从模板创建PO，提高创建效率
9. 系统应支持批量导入PO功能，从Excel或CSV文件导入
10. 系统应在创建过程中实时验证数据完整性和业务规则

### 需求3：供应商信息管理

**用户故事：** 作为采购员，我希望能够在PO中管理供应商信息，以便维护准确的供应商关系和联系详情。

#### 验收标准

1. 系统应为每个PO存储供应商名称、代码、联系人、电话和邮箱
2. 系统应验证供应商联系信息格式
3. 系统应支持供应商地址信息以协调发货
4. 当选择供应商时，系统应自动填充已知的联系信息
5. 系统应在PO上下文中维护供应商沟通历史

### 需求4：商品行管理

**用户故事：** 作为采购员，我希望能够管理PO中的商品行，以便准确记录采购的商品信息和数量。

#### 验收标准

1. 系统应支持在单个PO中添加多个商品行
2. 每个商品行应包含SKU代码、商品名称、规格、数量、单位、单价、税率
3. 系统应自动计算每行的税额和行金额
4. 系统应支持商品行的批量编辑操作
5. 系统应验证商品行的数量和单价必须大于0
6. 系统应支持为需要序列号或批次号管理的商品预先指定SN/LOT

### 需求5：物流跟踪管理

**用户故事：** 作为采购员，我希望能够跟踪PO的物流状态，以便及时了解货物的运输情况。

#### 验收标准

1. 系统应支持创建ASN（预发货通知）记录
2. 系统应记录承运商、跟踪号、发运状态、预计到达时间
3. 系统应支持运输状态的实时更新：SHIPPED（已发货）、IN_TRANSIT（运输中）、ARRIVED（已到达）
4. 系统应支持物流异常的记录和处理
5. 系统应提供跟踪号的一键查询功能

### 需求6：收货管理

**用户故事：** 作为仓库管理员，我希望能够确认PO的收货，以便准确更新库存和完成采购流程。

#### 验收标准

1. 系统应区分本地仓库和第三方仓库的收货流程
2. 系统应支持直接收货场景：从NEW状态直接创建收货单，跳过发运环节
3. 系统应支持标准收货场景：货物先发运后收货的完整流程
4. 对于本地仓库，系统应提供直接收货确认功能
5. 对于第三方仓库，系统应支持创建收货请求
6. 系统应记录实际收货数量、收货时间、收货人、质量状态
7. 系统应自动计算收货差异并支持差异原因记录
8. 系统应根据收货情况自动更新PO状态
9. 系统应支持在收货过程中的补发货操作

### 需求7：异常处理

**用户故事：** 作为采购经理，我希望能够处理PO执行过程中的异常情况，以便确保采购流程的顺利进行。

#### 验收标准

1. 系统应支持异常状态的标记和管理
2. 系统应支持RTV（退供）流程的创建和跟踪
3. 系统应记录异常原因、处理方案、处理状态
4. 系统应支持异常PO的重开和恢复功能
5. 系统应提供异常统计和分析报告

### 需求8：批量操作

**用户故事：** 作为采购员，我希望能够对多个PO执行批量操作，以便提高工作效率。

#### 验收标准

1. 系统应支持基于PO状态的智能批量操作
2. 系统应支持批量发送、批量创建发运单、批量标记送达等操作
3. 系统应支持批量导出和批量打印功能
4. 系统应在执行批量操作前进行权限和状态验证
5. 系统应记录批量操作的执行结果和失败原因

### 需求9：权限控制

**用户故事：** 作为系统管理员，我希望能够控制不同用户对PO的操作权限，以便确保数据安全和业务合规。

#### 验收标准

1. 系统应区分手动创建PO和PR转换PO的编辑权限
2. 系统应根据PO状态限制编辑权限
3. 对于PR转换的PO，供应商、仓库、币种、SKU应为只读
4. 系统应在界面上清晰显示字段的编辑权限状态
5. 系统应记录所有权限相关的操作日志

### 需求10：搜索和筛选

**用户故事：** 作为采购员，我希望能够快速搜索和筛选PO，以便高效地找到需要处理的订单。

#### 验收标准

1. 系统应支持基础搜索，包括PO编号、供应商名称、参考编号等字段
2. 系统应支持高级搜索，包括多字段组合和批量搜索
3. 系统应支持按状态、供应商、仓库、创建方式等维度筛选
4. 系统应支持时间范围筛选
5. 系统应保存搜索历史，支持快速重复搜索

### 需求11：数据展示和导出

**用户故事：** 作为采购经理，我希望能够查看PO的详细信息和统计数据，以便进行采购分析和决策。

#### 验收标准

1. 系统应提供PO列表的多维度展示，支持列的显示/隐藏和排序
2. 系统应提供PO详情的多标签页展示，包括基本信息、商品行、发运信息、收货记录、退供信息
3. 系统应支持PO数据的导出功能，包括Excel、PDF等格式
4. 系统应提供PO统计分析功能，包括状态分布、供应商分析等
5. 系统应支持自定义报表的生成和导出

### 需求12：国际化支持

**用户故事：** 作为国际业务用户，我希望系统能够支持多语言，以便在不同地区使用。

#### 验收标准

1. 系统应支持中英文界面切换
2. 系统应支持所有状态标签的多语言显示
3. 系统应支持表单字段和提示信息的多语言
4. 系统应支持操作按钮和菜单的多语言
5. 系统应根据用户设置自动选择合适的语言

### 需求13：响应式设计

**用户故事：** 作为移动端用户，我希望能够在不同设备上使用PO系统，以便随时随地处理采购业务。

#### 验收标准

1. 系统应支持桌面端、平板端、手机端的响应式布局
2. 系统应在移动端提供友好的触控操作体验
3. 系统应在小屏幕设备上合理调整表格和表单布局
4. 系统应确保关键功能在移动端的可用性
5. 系统应优化移动端的加载速度和性能

### 需求14：数据安全和审计

**用户故事：** 作为合规官，我希望系统能够确保数据安全和提供完整的审计跟踪，以便满足合规要求。

#### 验收标准

1. 系统应记录所有PO相关操作的审计日志
2. 系统应支持敏感数据的加密存储
3. 系统应提供用户操作权限的审计跟踪
4. 系统应支持数据备份和恢复功能
5. 系统应符合相关的数据保护法规要求

### 需求15：集成接口

**用户故事：** 作为系统集成工程师，我希望PO系统能够与其他业务系统集成，以便实现数据的自动同步和业务流程的自动化。

#### 验收标准

1. 系统应提供标准的API接口用于数据交换
2. 系统应支持与ERP系统的集成，同步供应商和商品信息
3. 系统应支持与WMS系统的集成，同步库存和收货信息
4. 系统应支持与财务系统的集成，同步成本和付款信息
5. 系统应提供接口调用的监控和日志记录功能
### 需求16：直接收货场景支持

**用户故事：** 作为采购员，我希望能够支持无需发运的直接收货场景，以便处理本地供应商送货、自提货物等特殊业务情况。

#### 验收标准

1. 系统应支持从NEW状态直接创建收货单，跳过发运环节
2. 当选择直接收货时，系统应将PO状态从NEW直接流转到RECEIVING
3. 系统应在直接收货场景下仍然记录完整的收货信息
4. 系统应支持直接收货后的补发货操作（如有剩余未收货物需要后续发运）
5. 系统应在PO详情中清晰标识直接收货的记录，区别于标准发运收货
6. 系统应支持直接收货场景下的部分收货和完整收货流程
7. 系统应在批量操作中支持批量直接收货功能
8. 系统应为直接收货场景提供相应的权限控制和审计跟踪
### 需求17：PO新增页面功能

**用户故事：** 作为采购员，我希望有一个完整的PO新增页面，以便能够方便地创建新的采购订单。

#### 验收标准

1. 系统应提供专门的PO新增页面，包含所有必要的信息输入区域
2. 系统应将新增页面分为四个主要区域：基础信息、供应商与交付信息、商品行管理、附件和备注
3. 基础信息区域应包含：PO编号（自动生成）、原始PO编号、参考编号、优先级、部门、预算项目、采购类型
4. 供应商与交付信息区域应包含：供应商信息、发货地址、收货地址、交付条件、成本信息
5. 商品行管理区域应支持：商品选择、批量编辑、SN/LOT管理、行级供应商设置
6. 系统应提供商品选择对话框，支持按SKU、商品名称、分类搜索和选择
7. 系统应支持商品行的批量操作：批量设置数量、币种、单价、税率、备注等
8. 系统应为需要序列号或批次号管理的商品提供SN/LOT管理对话框
9. 系统应实时计算和显示总金额、税额、各币种汇总等财务信息
10. 系统应提供三种保存选项：保存草稿、保存为已创建、保存并发送
11. 系统应在保存前进行完整的数据验证和业务规则检查
12. 系统应支持页面数据的自动保存功能，防止意外丢失
13. 系统应提供清晰的必填字段标识和验证错误提示
14. 系统应支持从其他PO复制创建新PO的功能